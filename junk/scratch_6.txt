X
    D
    dLdA

Y
    T

Z
    J if x_mode == 'kernel'
    dRdA if x_mode == 'kernel' and a_mode != 'decomposed'

A
    J
    K if a_mode == 'decomposed'
    D if not Z_equals_X
    dLdA if a_mode == 'decomposed'
    A_is_psd
    eigenvalues
    eigenvectors

E
    S if s
    I
    dSdE if s

T
    N
    Q
    I
    U

N
    O

Q
    O
    U

J
    K
    D if Z_equals_X
    dRdA if a_mode == 'decomposed'

K
    R if r
    dRdA if r

R
    F

S
    F

D
    I

I
    I_intr

I_intr
    O
    L if outer_loss is None
    U

O
    O_intr

O_intr
    L if outer_loss is not None
    U if outer_loss is not None

L
    F

F
    *

U
    subset_active_rows
    subset_active_cols
    subset_active_data
    V

subset_active_rows
    *

subset_active_cols
    *

subset_active_data
    V if reduce_derivative_matrix
    dLdA if reduce_derivative_matrix
    dLdE if reduce_derivative_matrix

V
    dLdA
    dLdE

dRdA
    dFdA

dLdA
    dFdA

dFdA
    phiA

phiA
    *

dSdE
    dFdE

dLdE
    dFdE

dFdE
    phiE

phiE
    *

A_is_psd
    *

eigenvalues
    *

eigenvectors
    *
